<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Hacker | HarveyNick.com]]></title>
  <link href="http://www.harveynick.com/blog/categories/hacker/atom.xml" rel="self"/>
  <link href="http://www.harveynick.com/"/>
  <updated>2013-03-19T22:49:52+00:00</updated>
  <id>http://www.harveynick.com/</id>
  <author>
    <name><![CDATA[Nick Johnson]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Now We're Blogging with Photos!]]></title>
    <link href="http://www.harveynick.com/blog/2012/04/14/now-were-blogging-with-photos/"/>
    <updated>2012-04-14T10:42:00+01:00</updated>
    <id>http://www.harveynick.com/blog/2012/04/14/now-were-blogging-with-photos</id>
    <content type="html"><![CDATA[<p><em>Fair warning: this is going to be a bit of a programming heavy blog post. It's also going to be quite Mac specific.</em></p>

<p>One of the things I wanted to change about the format of this blog was to make it more visual, specifically with pictures. This first part of this was to add pictures to the front page. There were a couple of options for doing so. I could just scan through an article, look for the first image tag and use this. Alternatively I could add a mechanism which allowed me to choose the image, in a similar manner to the way <a href="http://octopress.org/">Octopress</a> allows me to choose the except which appears on the front page. I decided to go with option two.</p>

<!-- more -->


<p>The first part of this was to modify the image tag plug-in like so:</p>

<p>{% codeblock image_tag.rb lang:ruby %}</p>

<p>module Jekyll</p>

<p>  class ImageTag &lt; Liquid::Tag</p>

<pre><code>@img = nil
@header = "" 

def initialize(tag_name, markup, tokens)
  attributes = ['class', 'src', 'width', 'height', 'title']

  if markup =~ /(?&lt;class&gt;\S.*\s+)?(?&lt;src&gt;(?:https?:\/\/|\/|\S+\/)\S+)(?:\s+(?&lt;width&gt;\d+))?(?:\s+(?&lt;height&gt;\d+))?(?&lt;title&gt;\s+.+)?/i
    @img = attributes.reduce({}) { |img, attr| img[attr] = $~[attr].strip if $~[attr]; img }
    if /(?:"|')(?&lt;title&gt;[^"']+)?(?:"|')\s+(?:"|')(?&lt;alt&gt;[^"']+)?(?:"|')/ =~ @img['title']
      @img['title']  = title
      @img['alt']    = alt
    else
      @img['alt']    = @img['title'].gsub!(/"/, '&amp;#34;') if @img['title']
    end
    @img['class'].gsub!(/"/, '') if @img['class']
    if tag_name == "header_img"
      @header = "&lt;!-- header_img #{@img['src']} --&gt;"
    end
  end
  super
end

def render(context)
  if @img
    "&lt;img #{@img.collect {|k,v| "#{k}=\"#{v}\"" if v}.join(" ")}&gt;#{@header}"
  else
    "Error processing input, expected syntax: {% img [class name(s)] [http[s]:/]/path/to/image [width [height]] [title text | \"title text\" [\"alt text\"]] %}"
  end
end
</code></pre>

<p>  end
end</p>

<p>Liquid::Template.register_tag('img', Jekyll::ImageTag)
Liquid::Template.register_tag('header_img', Jekyll::ImageTag)</p>

<p>{% endcodeblock %}</p>

<p>This adds an <code>html</code> comment containing the image path to the page when I use <code>header_img</code> as a <a href="https://github.com/Shopify/liquid/wiki">Liquid</a> tag name rather than the original <code>img</code>. Next I need to do something with this comment. I created an additional Liquid filter which pulls the path out and replaces it with an actual image embed:</p>

<p>{% codeblock harveynick_filters.rb lang:ruby %}</p>

<p>module HarveyNickFilters</p>

<p>  # Used on the blog index to split posts on the <!--more--> marker
  def header_image(input)</p>

<pre><code>if input =~ /&lt;!-- header_img (?&lt;src&gt;(?:https?:\/\/|\/|\S+\/)\S+) --&gt;/
  "&lt;img class=\"header\" src=\"#{$~['src']}\"/&gt;"
else
  ""
end
</code></pre>

<p>  end
end</p>

<p>Liquid::Template.register_filter(HarveyNickFilters)</p>

<p>{% endcodeblock %}</p>

<p>Next I modified my theme to run this filter over the page contents just before the one which creates the except on the front page. I'll leave this as an exercise for the reader. Lastly, I needed to account for the fact that the created image could be just about any size, while I want some uniformity on the front page. Those of you playing at home will have noticed I assigned <code>header</code> as the class of the image. This allows me to control the appearance of the front page images by adding the following to the <code>sass</code> files in my theme (which are used to generate the <code>css</code>):</p>

<p>{% codeblock _styles.scss lang:scss %}</p>

<p>img {
  &amp;.header{</p>

<pre><code>float: left;
width: 250px;
max-width: 50%;
margin-right: 10px;
margin-bottom: 10px;
@media only screen and (max-width: 768px) {
  width: 50%;
  max-width: 250px;
}
@media only screen and (max-width: 400px) {
  width: 100%;
  max-width: 100%;
  margin-right: 0px;
}
</code></pre>

<p>  }
}</p>

<p>{% endcodeblock %}</p>

<p>Presto. Front page images.</p>

<p>Next, I wanted to try and make it easier to include pictures which I myself have taken with an actual camera (or, more likely, my phone). There really isn't any problem when you're linking to images elsewhere on the internet, but things can get a bit stickier when you want to include your own images on an Octopress blog. One option is to use a hosted service, like Flickr or PhotoBucket, but this only works when you have an internet connection. I really love that Octopress allows me to work on my site while offline, and I didn't want to lose this advantage when I'm posting pictures. Thus, I decided to just stick the images in my blog's images folder.</p>

<p>iPhoto is pretty great for organising and sharing photos (with supported services), but definitely doesn't make your life easy if you want to actually get at the image files themselves. That's the first problem. The second is that I also want to resize them to something reasonable for my blog. Lastly I want this to be low hassle. I came to the conclusion that an <a href="http://en.wikipedia.org/wiki/AppleScript">Applescript</a> is what was required, and this is what I came up with:</p>

<p>{% codeblock bloggify.script lang:applescript %}</p>

<p>set blog_path to "~/GitHub/octopress/source"
set images_path to "/images/blog/"
set blog_image_path to blog_path &amp; images_path
set max_width to 992</p>

<p>set {year:y, month:m, day:d} to (current date)
set date_string to "" &amp; y &amp; "/" &amp; two_digits(m * 1) &amp; "/" &amp; two_digits(d)
set folder_path to blog_image_path &amp; date_string &amp; "/"</p>

<p>do shell script "mkdir -p " &amp; folder_path</p>

<p>tell application "iPhoto"</p>

<pre><code>set the_photos to selection
set the_photo to item 1 of the_photos
set image_path to image path of the_photo
set image_name to name of the_photo
</code></pre>

<p>end tell</p>

<p>tell application "Image Events"</p>

<pre><code>set current_image to open image_path
set image_type to current_image's file type
set AppleScript's text item delimiters to "/"
set image_path to last item of text items of image_path
set AppleScript's text item delimiters to ""
scale current_image to size max_width
set new_image to folder_path &amp; image_path
save current_image in new_image as image_type
</code></pre>

<p>end tell</p>

<p>set the clipboard to images_path &amp; date_string &amp; "/" &amp; image_path</p>

<p>on two_digits(the_number)</p>

<pre><code>return (text -2 thru -1 of ((the_number + 100) as string))
</code></pre>

<p>end two_digits</p>

<p>{% endcodeblock %}</p>

<p>Now, Applescript the programming language is completely mental and can be a complete pain in the arse to get right, but Applescript the mechanism is spectacularly powerful. You can do some serious automation with it. This script grabs the path to the currently selected photograph in iPhoto, resizes it and copies it to a folder inside my blog, generated using today's date to avoid duplication. Lastly, it places the location of the image on the clipboard, in the form it's needed.</p>

<p>To use it, I enabled the scripts menu (it's an option in the Applescript editor) and copied the script to the iPhoto scripts folder, which will be something like <code>/Users/&lt;user&gt;/Library/Scripts/Applications/iPhoto</code>. This might be hidden by default, but you can find it via the scripts menu while in iPhoto.</p>

<p>Then, all that is required is to select a photo, trigger the script, and then hit cmd-c in the post I'm writing. Bingo!</p>

<p>After getting this working, I remembered an <a href="http://arstechnica.com/apple/guides/2011/09/tutorial-os-x-automation-with-macruby-and-the-scripting-bridge.ars/2">ArsTecnica article</a> about using <a href="http://www.ruby-lang.org/en/">Ruby</a> in place of Applescript for this purpose, so I converted the script to Ruby as an exercise. This is what I came up with:</p>

<p>{% codeblock blogify.rb lang:ruby %}</p>

<h1>!/usr/local/bin/macruby</h1>

<p>framework "ScriptingBridge"</p>

<p>blog_path = "~/GitHub/octopress/source"
images_path = "/images/blog/"
max_width = 992
convert = "/opt/local/bin/convert"</p>

<p>date_string = Time.now.strftime("%Y/%m/%d")</p>

<p>source_path = SBApplication.applicationWithBundleIdentifier("com.apple.iPhoto").selection[0].imagePath.sub(" ", "\ ")
image_name = source_path.split("/")[-1]
destination_folder = "#{blog_path}#{images_path}#{date_string}".sub(" ", "\ ")
destination_path = "#{destination_folder}/#{image_name}"</p>

<p>ensure_dir_cmd = "mkdir -p #{destination_folder}"
puts ensure_dir_cmd
system ensure_dir_cmd</p>

<p>convert_cmd = "#{convert} #{source_path} -resize #{max_width}x2000 #{destination_path}"
puts convert_cmd
system convert_cmd</p>

<p>IO.popen('pbcopy', 'w').print "#{images_path}#{date_string}/#{image_name}"</p>

<p>{% endcodeblock %}</p>

<p>Ruby is a much more sensible language, and this, to me, is a lot easier to follow. I'm fairly new to Ruby, so this might not actually be the most Ruby-ish way of doing it, mind. It should be noted that it will only work with <a href="http://www.macruby.org/">MacRuby</a>, though. You will also need <a href="http://www.imagemagick.org/script/index.php">ImageMagick</a> installed. I made this executable with a quick <code>chmod +x</code> and moved it to the iPhoto scripts folder as well, where it seems to work just fine. So now I have two options. Hopefully, someone out there finds this useful.</p>

<p>Finally, to prove it works, and because it feels a little strange to not actually have any pictures in this entry: here's a nice shot taken at Kew Gardens (which hopefully I'll talk about more later):</p>

<p>{% header_img center /images/blog/2012/04/14/IMG_0442.JPG %}</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Origin Story, Raspberry Pi, and the ZX Spectrum]]></title>
    <link href="http://www.harveynick.com/blog/2012/03/27/origin/"/>
    <updated>2012-03-27T23:41:00+01:00</updated>
    <id>http://www.harveynick.com/blog/2012/03/27/origin</id>
    <content type="html"><![CDATA[<p>One of the fun things about working for Google is that from time to time interesting people come into the office to give talks. We had Richard Dawkins a few weeks ago, who gave an interesting if… uncompromising talk. Yesterday we had one of the founders of the <a href="http://www.raspberrypi.org/">Raspberry Pi</a> foundation. For those or you who aren't aware, the Raspberry Pi is an extremely small (exactly credit card sized) and cheap ($25), yet very capable computing platform. The foundation is the charity formed to produce this hardware.</p>

<p>Why is a charity building computer hardware? Because there is a need for it, caused by a problem you're possibly not even aware of. Let me explain; for I am part of the problem. These days when I play computer games it's usually on my X-Box or iPhone. They make my life very easy in this regard, since I never have to worry about whether a game will actually run or not. It just works. They are essentially closed systems, though. There is a reasonably high barrier to entry if I actually want to start playing with them as a developer. Specifically: I can't do it on the device itself. Furthermore, the very simplicity of the device works against me in this regard, because very little action on my part is required to make it work.</p>

<p>It was not always this way. Let me tell you a story.</p>

<!-- more -->


<p>When I was 9 years old (I think), my parents bought me a <em>Sinclair ZX Spectrum +2A</em> computer. It's highly likely those words mean nothing to you. It looked like this:</p>

<p>{% header_img center http://upload.wikimedia.org/wikipedia/commons/thumb/6/6a/Spectrum_128-2.png/800px-Spectrum_128-2.png %}</p>

<p>Truly, it was a wondrous machine, with its 128kB of memory and complete lack of long term storage, and I was utterly thrilled with it. I'm a nerd. Of course I was. They also bought me a joystick, and a copy of <em>Teenage Mutant Ninja Turtles</em>. To load this game, you placed the tape (yes, as in audio cassette) into the drive and hit play, having selected the right option from the machine's opening menu. You then wandered off for a while to let the machine screech and whine away to itself while it loaded the game. Partly for this reason I quickly tired of the game. I got others eventually, but I was a curious and easily bored child, so I started to read the manual which came with the system.</p>

<p>The vast majority of this was actually a guide to programming in the version of the <a href="http://en.wikipedia.org/wiki/BASIC">BASIC</a> (Beginners' All Purpose Symbolic Instruction Code) supported by the <em>+2A</em>. I read it, and I started to tinker. The <em>Sinclair</em> gave you essentially three options after booting:</p>

<ol>
<li>Loading a program from tape;</li>
<li>Program in +2A mode;</li>
<li>Program in 48k mode.</li>
</ol>


<p>The first two are fairly straight forward, but the third was a bit of an odd beast. It emulated the older <em>ZX Spectrum 48k</em>, which looked like this:</p>

<p>{% img center http://upload.wikimedia.org/wikipedia/commons/thumb/3/33/ZXSpectrum48k.jpg/800px-ZXSpectrum48k.jpg %}</p>

<p>You might notice that there seems to be an awful lot of extra writing on those keys. This is because each key had one or more BASIC keywords bound to it. In 48k mode you couldn't just type your program, you have to press the right key for the keyword you were looking for. This could be fast, or it could be <em>slow</em>. Especially if your keyboard lacked this extra data.</p>

<p>The <em>Spectrum</em> also had one or two other interesting quirks. For example, take a look at this screen shot from the classic <em>Treasure Island Dizzy</em>:</p>

<p>{% img center http://upload.wikimedia.org/wikipedia/en/4/44/Treasure_Island_Dizzy.png %}</p>

<p>For a start, this screen shot is showing fully more than half of the colours the <em>Sinclair</em> was capable of producing. Secondly, you might notice that there's something slightly odd about the distribution of these colours. Specifically: each block of 8x8 pixels contains at most two, because this was the maximum allowed. Given the limitations of the system, you had to be quite creative if you wanted to produce something worthwhile. Nevertheless, it happened. Not not me, though, because I did very little more than tinker with it.</p>

<p>It did give me a feel for programming, such that I knew more or less what was expected of me when I arrived at Edinburgh University to study Computer Science, though. A course which did it's level best to beat every last scrap BASIC out of me, because BASIC, quite frankly, is a horrible language. It was a reasonable place to start, though, and it was how I started out, so I guess it wasn't all bad.</p>

<p>Today's computers are clearly a lot easier to use than the <em>Spectrum</em> ever was. For the general consumer, this is a very good thing (in my opinion), because you should not need to be a software engineer to operate one any more than you should need to be a mechanic to operate a car. I don't own any general purpose computers which aren't made by Apple. As a result (I would say), operating my computer requires an extremely low amount of hassle. I don't need to know how it works. If I did want to do some programming, in the simplest possible case, I could follow these steps:</p>

<ol>
<li>Push &lt;CMD> + &lt;Space></li>
<li>Type "Terminal&lt;Enter>"</li>
<li>Wait a moment for the terminal to load</li>
<li>Type "python&lt;Enter>"</li>
</ol>


<p>I can now start fiddling with the <a href="http://python.org">Python</a> programming language, which is a much better place to start than BASIC every was. A more likely scenario is that I might have to load a couple of other programs to help me, such as a good programmer's text editor. The point here is that I would have to know how to get my computer in this state in the first place, though. It's not front and centre as soon as I turn it on. The <em>Spectrum</em> <a href="http://en.wikipedia.org/wiki/Affordance">afforded</a> programming in ways that modern computers don't. As a result, a curious youngster is much less likely to start tinkering with their computer than they might have been *cough* 21 years ago *cough*.</p>

<p>Modern computers are very much not toys, at least not in the way a bucket of Lego bricks is. They are expensive pieces of equipment. You don't don't want kids carrying them backwards and forwards from school. Which is where the Raspberry Pi comes in. It is designed to be played with, and cheap enough that if play gets rough and the system breaks it's not actually that much of a big deal. It might be quite important for the economy of the UK (and perhaps your country too) that children start playing with computers again. Playing the way you can play with Lego, not the way you play with Action Man. Building things; breaking them; building them again: better.</p>

<p>{% img center http://upload.wikimedia.org/wikipedia/commons/thumb/9/9c/Raspberry_Pi_Beta_Board.jpg/800px-Raspberry_Pi_Beta_Board.jpg %}</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[New (ish) Year, New (ish) Blog]]></title>
    <link href="http://www.harveynick.com/blog/2012/03/17/new-ish-year-new-ish-blog/"/>
    <updated>2012-03-17T11:22:00+00:00</updated>
    <id>http://www.harveynick.com/blog/2012/03/17/new-ish-year-new-ish-blog</id>
    <content type="html"><![CDATA[<p>2011 was an interesting year for me. A lot changed. I turned 30. After 10 years of residency I moved away from Edinburgh, a city I love dearly, and took a job in London. With <a href="/blog/tags/google">Google</a>. As a result, I no longer work with <a href="/blog/tags/autonomous-underwater-vehicles">Autonomous Underwater Vehicles</a> for a living. Instead I build web services. Quite the change, I'm sure you'll agree. In the early months of the year I finally completed the corrections to my <a href="/blog/tags/phd">PhD</a>, and then in the summer: I graduated. It took 6 years (all together) but I am now Dr. Nick Johnson. I also <a href="/blog/2011/07/18/the-sound-of-one-hand-clapping/">lost my grandmother</a>, a fact which still brings me to tears on occasion.</p>

<p>In this light, the fact that I decided, towards the end of the year, to shift my blog away from <a href="http://wordpress.org">Wordpress</a> and over to its own domain barely even casts a shadow. I did, though, and as a result you're now reading these words on a site built using <a href="http://octopress.org">Octopress</a>, which is hosted at harveynick.com. As you may have noticed, all of the old posts from my <a href="http://harveynick.wordpress.com">wordpress site</a> have been ported over, minus the short film reviews, which you'll find <a href="http://ohsohumbleopinion.tumblr.com">here</a>. I'm not going to go into how I accomplished this, except to say: I did it the same way <a href="http://mattgemmell.com/2011/09/12/blogging-with-octopress/">Matt Gemmel did</a>.</p>

<!-- more -->


<p>{% pullquote %}
For the most part, this site is stock Octopress. I've played with the fonts, made the heading and background static and added a little more infrastructure (index pages for tags, embed scripts for YouTube and Vimeo videos and a couple of other bits). {"It's not finished, but it will serve well enough for me to try and start producing actual content again"}. I do want to make it a bit more visual, particularly the front page, and somehow integrate other content I produce into it. I also want to make it work a little better on mobile browsers and, lastly, make it a little bit more my own. The colours will change, and I'll try to find a background which doesn't require such a large file and isn't so closely associated with Apple.
{% endpullquote %}</p>

<p>What will I be writing about though? Well:</p>

<p>I plan to have <a href="/blog/tags/clockwork-aphid">Clockwork Aphid</a> actually doing something of use this year. I'm going to enhance the current Java version up to a point where it can generate interesting landscapes efficiently and in a parallel fashion. I'm then going to then have a crack at porting it to <a href="http://golang.org">Go</a>, which I think may turn out to be an excellent language for writing computer games.</p>

<p>I like films. Perchance you may have noticed. I may chat a bit more in depth about a couple of this year's releases. Just to pick three with a common theme off the top of my head:</p>

<ul>
<li><strong>The Amazing Spider-Man</strong>. I went to a preview event for this in Leicester Square a month or two ago and was very impressed with what I saw. I'm hopeful they made a Spider-Man movie in the same way that Christopher Nolan makes Batman movies. Really really.</li>
<li><strong>The Dark Knight Rises</strong>. Speaking of which. This <em>is</em> exciting. It's the last of the trilogy. It's got a lot to live up to, especially since the last film Nolan made was <em>Inception</em>. I wouldn't bet against it, though.</li>
<li><strong>The Avengers</strong>. Now here's a film with some scope. All these characters in one film? With this cast? Written and directed by <a href="http://en.wikipedia.org/wiki/Joss_Whedon">Joss Mother Fucking* Whedon</a>? Please, please let this film live up to the frankly stupid amount of potential it has.</li>
</ul>


<p>Quite recently, at the aforementioned age of 30, I started playing Dungeons and Dragons with a selection of my colleagues. Well, we're actually playing <a href="http://en.wikipedia.org/wiki/Pathfinder_Roleplaying_Game">Pathfinder</a>, but let us not quibble about semantics. I'm having a really great time on several different levels. It's an interesting experience for someone who has played computer games for most of their life, but never dabbled in table top RPGs.</p>

<p>I mentioned before that I now have a shiny new PhD, with the letters before and after my name to prove it. I'm of the opinion that the work which led to this is quite interesting (but then I would be). It's also not completely divorced from my Clockwork Aphid project. I'm of a mind to try talking about this some, also.</p>

<p>See you when we get there.</p>

<p>* I think these are his actual middle names.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Simplifying the Landscape]]></title>
    <link href="http://www.harveynick.com/blog/2011/12/01/simplifying-the-landscape/"/>
    <updated>2011-12-01T09:28:05+00:00</updated>
    <id>http://www.harveynick.com/blog/2011/12/01/simplifying-the-landscape</id>
    <content type="html"><![CDATA[<p>At the end of the <a href="/blog/2010/10/22/now-in-eye-popping-3d/">last post</a> I wrote about the actual implementation of my Clockwork Aphid project, I said the next step was going to be display simplification. At that point I'd generated a few landscapes which were just starting barely starting to test the limits of my computer, though they were nothing like the size or complexity I had in mind. That said, it was looking at landscapes containing 1579008 polygons and it was obvious that not all of these needed to be put on screen. Moreover, because my landscapes are essentially made up of discrete samples (or nodes): I needed to reduce the number of samples which were displayed to the user, otherwise my performance was really going to tank as the landscapes increased in size.</p>

<!-- more -->


<p>Shamus Young talked about terrain simplification <a href="http://www.shamusyoung.com/twentysidedtale/?p=142">some time ago</a> during his original terrain project. This seemed as good a place as any to start, so I grabbed a copy of <a href="http://citeseer.ist.psu.edu/viewdoc/summary?doi=10.1.1.14.4771">the paper</a> he used to build his algorithm. I didn't find it as complicated as it appears he did, but this is probably because I'm more used to reading papers like this (I must have read hundreds during my PhD, and even wrote a couple), so I'm reasonably fluent in academicese. It was, as I suspected, a good starting point, though I wouldn't be able to use the algorithm wholesale as it's not directly compatible with the representation I'm using. Happily, my representation does make it very simple to use the core idea, though.</p>

<p>If you <a href="/blog/2010/10/19/youre-speaking-my-landscape-baby/">remember</a>, my representation stores the individual points in a sparse array, indexed using fractional coordinates. This makes it very flexible, and allows me to use an irregular level of detail (more on that later). Unlike the representation used in the paper, this means a can't make optimisations based on the assumption that my data is stored in a regular grid. Thankfully, the first stage of the simplification algorithm doesn't care about this and examines points individually. Also thankfully, the simplification algorithm uses the same parent/child based tessellation strategy that I do.</p>

<p>The first step is decide which points are "active". This is essentially based on two variables:</p>

<ul>
<li>The amount of "object space error" a point has (i.e. how much it differs from its parents);</li>
<li>The distance between the point and the "camera".</li>
</ul>


<p>A local constant is also present for each point:</p>

<ul>
<li>The point's bounding radius, or the distance to its furthest child (if it has children);</li>
</ul>


<p>I'm not sure if I actually need this last in my current implementation (my gut says no, I'll explain why later), but I'm leaving it in for the time being. Finally, two global constants are used for tuning, and we end up with this:</p>

<p>{% img center http://harveynick.files.wordpress.com/2011/12/simplificationequation21.png %}</p>

<p>Where:</p>

<ul>
<li><em>i</em> = the point in question</li>
<li><em>λ</em> = a constant</li>
<li><em>ε<sub>i</sub></em> = the object space error of <em>i</em></li>
<li><em>d<sub>i</sub></em> = the distance between <em>i</em> and the camera</li>
<li><em>r<sub>i</sub></em> = the bounding radius of <em>i</em></li>
<li><em>τ</em> = another constant</li>
</ul>


<p>This is not entirely optimal for processing, but a little bit of maths wizardry transforms this like so:</p>

<p>{% img center http://harveynick.files.wordpress.com/2011/12/simplificationequation31.png %}</p>

<p>This looks more complicated, and it's less intuitive to see what it actually does, but from the point of view of the computer it's a lot simpler, as it avoids the square root needed to calculate the distance between the point and the camera. Now we get to the fun part: diagrams! Consider the following small landscape, coloured as to the granularity of each of the points (aka the distance to the node's parents, see <a href="/blog/2010/10/22/fractal-errata/">this post</a>):</p>

<p>{% img center http://harveynick.files.wordpress.com/2011/12/allpoints.jpg %}</p>

<p>Next, we'll pick some arbitrary values for the constants mentioned above (ones which work well for explanatory purposes), and place the viewpoint in the top left hand corner, and we end up with this the following active points (inactive points are hidden):</p>

<p>{% img center http://harveynick.files.wordpress.com/2011/12/activepoints.jpg %}</p>

<p>Now, we take the active points with the smallest granularity, and we have them draw their polygons, <a href="/blog/2010/10/22/now-in-eye-popping-3d/">exactly as before</a>, which looks like this:</p>

<p>{% img center http://harveynick.files.wordpress.com/2011/12/smallestpolygons.jpg %}</p>

<p>When we come to draw the polygons of the next highest granularity you'll see that we have a problem, though. The previous set of polygons have encroached on their territory. To avoid this, each node informs its parents that it is active and then the parent doesn't draw any polygons in the direction of its active children. If we add in the polygons drawn by the each of the other levels of granularity, we now end up with this:</p>

<p>{% img center http://harveynick.files.wordpress.com/2011/12/filledpolygons.jpg %}</p>

<p>Oh no! There's a hole in my landscape! I was actually expecting that my simplistic approach would lead to more or less this result, but it was still a little annoying when it happened. If I was a proper analytical type I would next have sat down and worked over the geometry at play here, then attempted to find a formulation which would prevent this from happening. Instead, though, I stared at it for a good long while, displaying it in various different ways, and waited for something to jump out at me.</p>

<p>Eventually it did, and thankfully it was a very simple rule. Each parent stores a list of the directions in which it has active children in order to prevent overdrawing (as mentioned above). The new rule is that a node is also considered active if this list is non-empty. With this addition, our tessellated landscape now look alike this:</p>

<p>{% img center http://harveynick.files.wordpress.com/2011/12/backfilledpolygons.jpg %}</p>

<p>Presto! A nice simple rule which fills in all of the gaps in the landscape without any over or under simplification, or any overdrawing. I suspect this rule also negates the need for the bounding radius mentioned above, though I have not as yet tested that thought. To recap, we have three simple rules:</p>

<ol>
<li>A node is active if the object space error/distance equation says it is;</li>
<li>A node is active if any of its children are active;</li>
<li>Polygons are tessellated for each active point, but not in the direction of any active children.</li>
</ol>


<p>But what does this look like in actual eye poppingly 3D landscapes? Well, here's an example, using the height based colouring I've used before:</p>

<p>{% header_img center http://harveynick.files.wordpress.com/2011/12/simplifiedlandscape.jpg %}</p>

<p>I'm quite pleased with this, though what I'm doing here is still quite inefficient and in need of some serious tuning. There are a couple of further simplification tricks I can try (including the next step from the (paper) paper). More to come later. Honest.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Revisiting the Language Issue]]></title>
    <link href="http://www.harveynick.com/blog/2011/09/14/revisiting-the-language-issue/"/>
    <updated>2011-09-14T10:00:14+01:00</updated>
    <id>http://www.harveynick.com/blog/2011/09/14/revisiting-the-language-issue</id>
    <content type="html"><![CDATA[<p>Some time ago, I wrote a <a href="/blog/2010/10/09/youre-speaking-my-language-baby-part-1-introduction/">series</a> <a href="/blog/2010/10/10/youre-speaking-my-language-baby-part-2-java/">of</a> <a href="/blog/2010/10/11/youre-speaking-my-language-baby-part-3-c/">posts</a> <a href="/blog/2010/10/12/youre-speaking-my-language-baby-part-4-objective-c/">about</a> <a href="/blog/2010/10/13/youre-speaking-my-language-baby-part-5-conclusion/">language</a> choice for my Clockwork Aphid project. In the end I decided to start the project in Java, this being the language I'm most comfortable with. Once the project reaches a stable state, with some minimum amount of functionality, the plan is to port it to C++ for comparison purposes, this being the language which is likely to provide the best performance.</p>

<p>I still plan on doing this, but I've also decided to add a couple of extra candidate languages to the melting pot and get an even broader comparison. The first of these languages is Go, a relatively new language developed at Google. This is not coincidence. I've been doing some reading about it lately and finding a lot of things I really like. It has the potential to provide the benefits of both Java <em>and</em> C++, whilst avoiding many of the pitfalls. This is definitely a good thing. It will also give me chance to dogfood (there's <a href="/blog/2011/08/26/dogfood-nom-nom-nom/">that word</a> again!) some more Google technology.</p>

<!-- more -->


<p>One of Go's features which I really like is implicit interfaces. Allow me to explain. In most regular statically typed object orientated languages, such as Java (which I'll use for this example), you can abstract functionality using something like an interface. For example, let's say I have a class which looks like this:</p>

<p>{% codeblock lang:java %}
class Counter {
  int value;
  int get() {</p>

<pre><code>return value;
</code></pre>

<p>  }
}
{% endcodeblock %}</p>

<p>Here we have defined an class which declares a single method which returns an integer value. I might then make use of this an instance of this class elsewhere:</p>

<p>{% codeblock lang:java %}
class Printer {
  void update(Counter counter) {</p>

<pre><code>System.out.println(counter.get());
</code></pre>

<p>  }
}
{% endcodeblock %}</p>

<p>All is good with the world, unless I decide I want to change the behaviour of the code. Perhaps I want the value to increment after each call, for example. I could extend the Counter class and change its behaviour that way:</p>

<p>{% codeblock lang:java %}
class IncrementingCounter extends Counter {
  int get() {</p>

<pre><code>return value++;
</code></pre>

<p>  }
}
{% endcodeblock %}</p>

<p>I can now pass an instance of this new class into the update method of the Handler. Done. Right? Well... no. This is a bit of a clumsy way to go about this. It doesn't scale and it's not always possible. A better way to handle this is to use an interface:</p>

<p>{% codeblock lang:java %}
interface CounterInterface {
  int get();
}
{% endcodeblock %}</p>

<p>This specifies the interface of the methods, but not their implementation. We can then change the Printer class to use this interface, rather than the concrete class:</p>

<p>{% codeblock lang:java %}
class Printer {
  void update(CounterInterface counter) {</p>

<pre><code>System.out.println(counter.get());
</code></pre>

<p>  }
}
{% endcodeblock %}</p>

<p>Now any class which implements this interface can be passed to the Printer. So, going to back to our original example:</p>

<p>{% codeblock lang:java %}
class Counter implements CounterInterface {
  int value;
  int get() {</p>

<pre><code>return value;
</code></pre>

<p>  }
}
{% endcodeblock %}</p>

<p>We can now make any number of alternative implementations (incrementing, decrementing, random, fibronatchi…) and as long as they implement the interface they can be passed to the printer. This is fine if you're in control of the implementation, and even more fine if you're in control of the interface as well. There are times, however, when you're in change of neither. Things can get a little messy and you may have to find a way of pushing a round peg through a square hole.</p>

<p>In dynamically typed languages, such as Python and Ruby, things work a little differently. These languages are often referred to as being "duck" typed, as they make the assumption that if something "looks like a duck and quacks like a duck, treat it as though it's a duck." In this case we wouldn't bother with any of the interfaces and our Printer class would look more like this:</p>

<p>{% codeblock lang:python %}
class Printer:
  def update(counter):</p>

<pre><code>print counter.get()
</code></pre>

<p>{% endcodeblock %}</p>

<p>So long as the counter object has a method called get() we don't have a problem. Everything will be fine. This is much simpler, and is one of the things which makes Python very quick to program in, but it does have problems. The main problem (for me, at least) is specification. Without examining the source code, I can't see what sort of object I have to pass into the update method. If the method has been manually commented then there's no problem, but this is an incredible tedious thing to have to do. In the Java code I can see the type right there in the auto-generated documentation, and even if the writer has written no comments at all (what a bastard!) I can still get a good idea of what I need to pass into the method.</p>

<p>Go takes a different approach. It's statically typed, and it has interfaces, but a class doesn't need to state that it implements an interface. This is implicit and automatic. If a class has the methods defined in an interface, then it is automatically considered to implement it. You get the flexibility of Python with the specification and predicability of Java. This is just one of the things in Go which I think is a really good idea.</p>

<p>On the other hand, I think functional programming is a really stupid idea. I find the languages to be completely horrendous. I feel they must be created by the sort of people who think Linux is user friendly. I consider them curiosities whose only merit is academic. It appears to me that their major use case is to make programming appear more obscure than it actually is and to abstract way the programmer's knowledge of what the computer is actually doing.</p>

<p>You may be surprised to learn, then, that the third language I'm going to be trying to port Clockwork Aphid into is Scala, a functional programming language. The reason for this is simple: while I personally believe that functional programming (FP) is rubbish, many people disagree. Not a majority, but certainly a very vocal minority. Within Google this minority is very vocal in indeed. The word "fundamentalists" might be appropriate to describe them. When someone believes something that hard it makes me very curious. This is turn tends to lead me towards testing my own beliefs. Sometimes I discover something new and exciting which I was missing out on previously*, and sometimes my initial suspicions are confirmed**. We'll see which way it goes with Scala.</p>

<p>* Such as the Harry Potter books, which I had stubbornly refused to read until just before the first film was released.<br/>
** Such as when I noticed that the Twilight books had taken up the first four places on the Waterstone's chart and decided I aught to find out what all the fuss was about.</p>
]]></content>
  </entry>
  
</feed>
